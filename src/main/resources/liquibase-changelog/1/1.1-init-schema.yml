databaseChangeLog:
    - changeSet:
          id: 1
          author: bh
          changes:
              - sql: |
                    CREATE TABLE parent (
                        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        first_name VARCHAR(50) NOT NULL,
                        last_name VARCHAR(50) NOT NULL,
                        email VARCHAR(100) NOT NULL UNIQUE,
                        password VARCHAR(255) NOT NULL,
                        phone VARCHAR(20),
                        creation_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
                        created_by VARCHAR(20) DEFAULT '',
                        update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                        updated_by VARCHAR(40) DEFAULT ''
                    );
              - sql: |
                    CREATE TABLE child (
                        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        parent_id BIGINT NOT NULL,
                        first_name VARCHAR(50) NOT NULL,
                        last_name VARCHAR(50) NOT NULL,
                        birthdate DATE NOT NULL,
                        notes TEXT,
                        creation_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
                        created_by VARCHAR(20) DEFAULT '',
                        update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                        updated_by VARCHAR(40) DEFAULT '',
                        CONSTRAINT fk_child_parent FOREIGN KEY (parent_id) REFERENCES parent(id) ON DELETE CASCADE
                    );
              - sql: |
                    CREATE TABLE medication (
                        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        name VARCHAR(100) NOT NULL,
                        brand VARCHAR(100),
                        description TEXT,
                        dosage_form VARCHAR(50),
                        instructions TEXT,
                        creation_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
                        created_by VARCHAR(20) DEFAULT '',
                        update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                        updated_by VARCHAR(40) DEFAULT ''
                    );
              - sql: |
                    CREATE TABLE prescription (
                        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        child_id BIGINT NOT NULL,
                        medication_id BIGINT NOT NULL,
                        dosage_amount NUMERIC(6,2) NOT NULL,
                        dosage_unit VARCHAR(20) NOT NULL,
                        frequency_per_day INT,
                        start_date DATE NOT NULL,
                        end_date DATE,
                        notes TEXT,
                        creation_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
                        created_by VARCHAR(20) DEFAULT '',
                        update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                        updated_by VARCHAR(40) DEFAULT '',
                        CONSTRAINT fk_prescription_child FOREIGN KEY (child_id) REFERENCES child(id) ON DELETE CASCADE,
                        CONSTRAINT fk_prescription_medication FOREIGN KEY (medication_id) REFERENCES medication(id) ON DELETE RESTRICT
                    );
              - sql: |
                    CREATE TABLE dosage_log (
                        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        dosage_given NUMERIC(6,2) NOT NULL,
                        administered_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
                        notes TEXT,
                        creation_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
                        created_by VARCHAR(20) DEFAULT '',
                        update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                        updated_by VARCHAR(40) DEFAULT ''
                    );
              - sql: |
                    CREATE TABLE medication_open_log (
                        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        notes TEXT,
                        creation_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
                        created_by VARCHAR(20) DEFAULT '',
                        update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                        updated_by VARCHAR(40) DEFAULT ''
                    );
              - sql: |
                    CREATE TABLE notification (
                        id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
                        parent_id BIGINT NOT NULL,
                        child_id BIGINT,
                        message VARCHAR(255) NOT NULL,
                        is_read BOOLEAN NOT NULL DEFAULT false,
                        creation_date TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
                        created_by VARCHAR(20) DEFAULT '',
                        update_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                        updated_by VARCHAR(40) DEFAULT '',
                        CONSTRAINT fk_notification_parent FOREIGN KEY (parent_id) REFERENCES parent(id) ON DELETE CASCADE,
                        CONSTRAINT fk_notification_child FOREIGN KEY (child_id) REFERENCES child(id)
                    );
